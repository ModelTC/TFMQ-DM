<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
    <!-- Replace the content tag with appropriate information -->
    <meta name="description" content="TFMQ-DM: Temporal Feature Maintenance Quantization for Diffusion Models">
    <meta property="og:title" content="TFMQ-DM"/>
    <meta name="keywords" content="Diffusion, PTQ, Post-training, Quantization">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
    <title>TFMQ-DM: Temporal Feature Maintenance Quantization for Diffusion Models</title>
    <link rel="icon" type="image/x-icon" href="static/images/logo.png">
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
    rel="stylesheet">
  
    <link rel="stylesheet" href="static/css/bulma.min.css">
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
    <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="static/css/index.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
    <script defer src="static/js/fontawesome.all.min.js"></script>
    <script src="static/js/bulma-carousel.min.js"></script>
    <script src="static/js/bulma-slider.min.js"></script>
    <script src="static/js/index.js"></script>
  </head>
  <body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">TFMQ-DM: Temporal Feature Maintenance Quantization for Diffusion Models</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://github.com/Harahan" target="_blank">Yushi Huang</a><sup>1,2*</sup>,</span>
                <span class="author-block">
                  <a href="https://xhplus.github.io/" target="_blank">Ruihao Gong</a><sup>1,2*</sup>,</span>
                  <span class="author-block">
                    <a href="https://jing-liu.com/" target="_blank">Jing Liu</a><sup>2,3</sup>,</span>
                    <span class="author-block">
                      <a href="https://tianlong-chen.github.io/" target="_blank">Tianlong Chen</a><sup>4</sup>,</span>
                      <span class="author-block">
                        <a href="https://xlliu-beihang.github.io/" target="_blank">Xianglong Liu</a><sup>1ðŸ“§</sup>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Beihang University<sup>1</sup>,</span>
                    <span class="author-block">SenseTime Research<sup>2</sup>,</span>
                    <span class="author-block">Monash University<sup>3</sup></span>
                    <span class="author-block">UT Austin<sup>4</sup></span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="paper-block"><b>CVPR 2024 Highlight </b><b style="color:#d31313;">(Acceptence Rate 2.8%)</b><br>
                    <span class="author-block">*Equal Contribution, ðŸ“§Corresponding Author</span><br>
                    <span class="author-block"><a href="mailto:huangyushi@sensetime.com">huangyushi@sensetime.com</a>,</span>
                    <span class="author-block"><a href="mailto:gongruihao@sensetime.com">gongruihao@sensetime.com</a>,</span>
                    <span class="author-block"><a href="liujing5@sensetime.com">liujing5@sensetime.com</a>,</span><br>
                    <span class="author-block"><a href="tianlong.chen@utexas.edu">tianlong.chen@utexas.edu</a>,</span>
                    <span class="author-block"><a href="xlliu@buaa.edu.cn">xlliu@buaa.edu.cn</span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/2311.16503" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- Supplementary PDF link -->
                    <!-- <span class="link-block">
                      <a href="static/pdfs/supplementary_material.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span> -->

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/ModelTC/TFMQ-DM" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2311.16503" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img id="teaser" width="100%" src="static/images/overview.png" style="display: block; margin: auto;">

      <h2 class="content has-text-justified">
        In <b>TFMQ-DM</b>, our contributions are as follows:
       
        <b>1) </b>we discover that existing quantization methods suffer from temporal feature disturbance, disrupting the denoising trajectory of diffusion models and significantly affecting the quality of generated images. 
        
        <b>2) </b>We reveal that the disturbance comes from two aspects: inappropriate reconstruction target and unaware of finite activations. Both inducements ignore the special characteristics of time information-related modulesã€‚ 
        
        <b>3) </b>An advanced framework (TFMQ-DM) is proposed, consisting of temporal information aware reconstruction (TIAR) for weight quantization and finite set calibration (FSC) for activation quantization. Both are based on a Temporal Information Block specially devised for diffusion models.
       
        <b>4) </b>Extensive experiments on various datasets show that our novel framework achieves a new state-of-the-art result in PTQ of diffusion models, especially under 4-bit weight quantization, and significantly accelerates quantization time. For some hard tasks, e.g., CelebA-HQ 256 Ã— 256, our method reduces the FID score by 6.71
    </h2>
    
    </div>
  </div>
</section>

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            The Diffusion model, a prevalent framework for image
        generation, encounters significant challenges in terms of
        broad applicability due to its extended inference times and
        substantial memory requirements. Efficient Post-training
        Quantization (PTQ) is pivotal for addressing these issues in
        traditional models. Different from traditional models, diffusion models heavily depend on the time-step t to achieve
        satisfactory multi-round denoising. Usually, t from the finite set {1, . . . , T} is encoded to a temporal feature by a
        few modules totally irrespective of the sampling data. However, existing PTQ methods do not optimize these modules
        separately. They adopt inappropriate reconstruction targets
        and complex calibration methods, resulting in a severe disturbance of the temporal feature and denoising trajectory,
        as well as a low compression efficiency. To solve these,
        we propose a Temporal Feature Maintenance Quantization
        (TFMQ) framework building upon a Temporal Information
        Block which is just related to the time-step t and unrelated
        to the sampling data. Powered by the pioneering block design, we devise temporal information aware reconstruction
        (TIAR) and finite set calibration (FSC) to align the fullprecision temporal features in a limited time. Equipped with
        the framework, we can maintain the most temporal information and ensure the end-to-end generation quality. Extensive experiments on various datasets and diffusion models
        prove our state-of-the-art results. Remarkably, our quantization approach, for the first time, achieves model performance nearly on par with the full-precision model under
        4-bit weight quantization. Additionally, our method incurs
        almost no extra computational cost and accelerates quantization time by 2.0Ã— on LSUN-Bedrooms 256 Ã— 256 compared to previous works. 
</p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered has-text-centered">
        <h2 class="title is-3">Visualization Results<br></h2>
      </div>
      
      <div class="columns is-centered has-text-centered" style="color: gray; font-size: small;">
        <h4> (The full-precision images are depicted in the upper line, and the images generated by quantized models are shown in the lower lines)</h4>
      </div>
      <div id="results-carousel">
       <table><tr>
        <td><div class="item">
          <!-- Your image here -->
          
          <center>
            <img src="static/images/vis-1_00.png" style="width: 70%;" alt="MY ALT TEXT"/>
          </center>
          
          <h4 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision LDM-4 on CelebA-HQ 256 Ã— 256. The resolution of each sample is
  256 Ã— 256.
          </h4>
        </div></td>
        <td><div class="item">
          <!-- Your image here -->
          
          <center>
            <img src="static/images/vis-2_00.png" style="width: 70%;" alt="MY ALT TEXT"/>
          </center>
          
          <h4 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision LDM-4 on FFHQ 256 Ã— 256. The resolution of each sample is
  256 Ã— 256.
          </h4>
        </div></td>
       </tr></table>
       
       <table><tr>
        <td><div class="item">
          <!-- Your image here -->
          <center>
            <img src="static/images/vis-3_00.png" style="width: 80%;" alt="MY ALT TEXT"/>
          </center>
          <h3 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision LDM-8 on LSUN-Churches 256Ã—256. The resolution of each sample
  is 256 Ã— 256.
          </h3>
        </div></td>
        <td><div class="item">
          <!-- Your image here -->
          <center>
            <img src="static/images/vis-4_00.png" style="width: 70%;" alt="MY ALT TEXT" />
          </center>
          <h3 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision LDM-4 on LSUN-Bedrooms 256Ã—256. The resolution of each sample
  is 256 Ã— 256.
         </h3>
       </div></td>
      </tr></table>

      <table><tr>
        <td><div class="item">
          <!-- Your image here -->
          <center>
           <img src="static/images/vis-5_00.png" style="width: 60%;" alt="MY ALT TEXT"/>
          </center>
          <h3 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision DDIM on CIFAR-10 32 Ã— 32. The resolution of each sample is
    32 Ã— 32.
          </h3>
        </div></td>
        <td><div class="item">
          <!-- Your image here -->
          <center>
           <img src="static/images/vis-6_00.png" style="width: 50%;" alt="MY ALT TEXT"/>
          </center>
          <h3 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision DDIM on CIFAR-10 32 Ã— 32. The resolution of each sample is
    32 Ã— 32.
          </h3>
        </div>
         <div class="item">
          <!-- Your image here -->
          <center>
            <img src="static/images/vis-7_00.png" style="width:90%;" alt="MY ALT TEXT" />
          </center>
          <h3 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Random samples from w4a8 quantized and full-precision Stable Diffusion. (Left) prompt: <b><i>"A digital illustration of the Babel
              tower, detailed, trending in artstation, fantasy vivid colors."</i></b> (Right) prompt: <b><i>"A beautiful castle beside a waterfall in the woods."</i></b> The
    resolution of each sample is 512 Ã— 512.
         </h3>
       </div>
       </div></td>
      </tr></table>

    
    
  </div>
</div>
</div>
</section>
<!-- End image carousel -->

<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered has-text-centered">
        <h2 class="title is-3">Acceleration Results<br></h2>
      </div>
      
      <div class="columns is-centered has-text-centered" style="color: gray; font-size: small;">
        <h4> We deploy the quantized Stable Diffusion on the IntelÂ® XeonÂ® Gold 6248R Processor</h4>
      </div>
      <div id="results-carousel">

        <div class="item">
          <!-- Your image here -->
          <center>
            <img src="static/images/acceleration.png" style="width:45%;" alt="MY ALT TEXT" />
          </center>
          <h3 class="subtitle is-6 has-text-centered" style="margin-bottom: 1.5em;">
            Inference analysis of Stable Diffusion with 50 denoising
time-steps on Intel CPU.
         </h3>
       </div>

      </div>
    </div>
    </div>
    </section>


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@inproceedings{huang2024tfmqdm,
  title={TFMQ-DM: Temporal Feature Maintenance Quantization for Diffusion Models}, 
  author={Yushi Huang and Ruihao Gong and Jing Liu and Tianlong Chen and Xianglong Liu},
  booktitle={The IEEE/CVF Conference on Computer Vision and Pattern Recognition},
  year={2024}
}
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from theÂ <a href="https://nerfies.github.io" target="_blank">Nerfies</a>Â project page.
            You are free to borrow the of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
